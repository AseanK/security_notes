# Web-based Exploits

Malicious code or behavior that's used to take advantage of coding flaws in a web application

## Injection attack

Malicious code inserted into a vulerable application

### Common type

- **XSS (Cross-site scripting)**
  - An attack that inserts code into a vulnerable website or web application
  - Often delivered by HTML and JavaScript
  - Three main types
    - **Reflected**
      - An instance when malicious script is sent to a server and activated during the server's response
      - E.g. Attacker sends the web link that appears to go to a trusted site but when clicked, it sends a HTTP request to the vulnerable site server. Then the server returns the malicious script to the user

    ![img](https://media.geeksforgeeks.org/wp-content/uploads/20190516153002/reflectedXSS.png)

    - **Stored**
      - An instance when malicious script is injected directly on the server
      - E.g. Attacker infest the target elements like image or a button on a web page. Infected elements activate the malicious code when pressed

    ![img](https://media.geeksforgeeks.org/wp-content/cdn-uploads/20190516153259/StoredXSS.png)

    - **DOM-based**
      - An instance when malicious script exists in the web page a browser loads
      - E.g. Attacker manipulates URL parameter that suspects an input
- **SQL injection**
  - An attack that excutes unexpected queries on a database
  - E.g. Injecting SQL code in the login form
  - Three main types
    - In-band
      - Most common type
      - Uses the *same communication channel* to launch the attack
    - Out-of-band
      - Uncommon because it only works when certain features are enabled on the target server
      - Uses a *different communication channel* to launch the attack
    - Inferential
      - Occurs when an attacker is unable to directly see the results of their attack
      - E.g. Injecting code that causes the system to respond with an error

## Prevention

A key is to escape user inputs (preventing someone from inserting any code that a program isn't expecting)

### Common ways to prevent

- **Prepared statements**
  - A coding techniqu that excutes SQL statements before passing them on to a database
- **Input sanitization**
  - Programming that removes user input which could be interpreted as code
- **Input validation**
  - Programming that ensures user input meets a system's expectations